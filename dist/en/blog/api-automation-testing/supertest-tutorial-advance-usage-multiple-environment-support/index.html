<!DOCTYPE html><html lang="en-US"> <head><meta charset="UTF-8"><title>SuperTest API Automation Testing Tutorial Advance Usage - Multiple Environment Support - Nao&#39;s Blog</title><meta name="description" content="naodeng, naodeng.com.cn, personal blog, software testing, performance testing, API testing, automation testing, agile testing."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="sitemap" href="/sitemap-index.xml"><meta name="generator" content="Astro v5.17.0"><link rel="alternate" hreflang="en-US" href="https://naodeng.com.cn/en/blog/api-automation-testing/supertest-tutorial-advance-usage-multiple-environment-support/"><link rel="alternate" hreflang="zh-CN" href="https://naodeng.com.cn/zh-cn/blog/api-automation-testing/supertest-tutorial-advance-usage-multiple-environment-support/"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="icon" sizes="192x192" href="/android-chrome-192x192.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="color-scheme" content="light dark"><meta property="og:type" content="website"><meta property="og:title" content="SuperTest API Automation Testing Tutorial Advance Usage - Multiple Environment Support - Nao's Blog"><meta property="og:site_name" content="SuperTest API Automation Testing Tutorial Advance Usage - Multiple Environment Support - Nao's Blog"><meta property="og:description" content="naodeng, naodeng.com.cn, personal blog, software testing, performance testing, API testing, automation testing, agile testing."><meta property="og:image" content="https://naodeng.com.cn/ogp.png"><meta property="og:url" content="https://naodeng.com.cn/en/blog/api-automation-testing/supertest-tutorial-advance-usage-multiple-environment-support/"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@inaodeng"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preload" as="style" fetchpriority="high" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;800&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;800&display=swap" media="print" onload="this.media='all'"><link rel="preload" as="style" fetchpriority="high" href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp&display=swap" media="print" onload="this.media='all'"><style>
    body {
      font-family: "Noto Sans", sans-serif;
    }
  </style><style>article[data-astro-cid-uwv4mmhs]{>*{margin-block:1.2em 0;margin-inline:0}p{font-weight:400}h2{margin-block:3em 0;padding-block-end:.2em;border-inline-start:4px solid var(--color-accent);padding-inline-start:var(--sp-s);line-height:1.4;font-size:1.6rem}h3{margin-block:2em 0;padding-block-end:.2em;line-height:1.4;font-size:1.4rem;border-block-end:1px solid color-mix(in srgb,var(--color-main) 10%,transparent)}h4{margin-block:2em -.4em;line-height:1.4;font-size:1.1rem}ul{list-style:disc;padding-inline-start:1.5em}ol{list-style:decimal;padding-inline-start:1.5em}li{margin-block:0 .5em;line-height:1.4}:not(pre) code{font-family:Consolas,Courier New,Courier,Monaco,monospace;color:var(--color-theme);background-color:color-mix(in srgb,var(--color-main) 8%,transparent);padding-block:.2em;padding-inline:.4em;border-radius:2px;font-size:.9rem}blockquote{font-style:italic;color:color-mix(in srgb,var(--color-main) 80%,transparent);background:color-mix(in srgb,var(--color-main) 5%,transparent);padding:1em;border-inline-start:2px solid color-mix(in srgb,var(--color-main) 10%,transparent)}a{text-decoration:underline;color:var(--color-theme);font-weight:500}img{border-radius:4px;background-color:color-mix(in srgb,var(--color-main) 10%,transparent)}pre{direction:ltr;padding:1em;border-radius:4px;border:2px solid color-mix(in srgb,var(--color-main) 20%,transparent)}}header[data-astro-cid-v3cnrnum]{text-align:center;border-block-end:1px solid var(--color-theme);padding-block-end:var(--sp-m);display:flex;flex-direction:column;align-items:center;gap:.5rem}header[data-astro-cid-v3cnrnum] h1[data-astro-cid-v3cnrnum]{color:var(--color-theme);font-size:1.8rem;margin:0}.cover[data-astro-cid-v3cnrnum]{border-radius:16px;margin:0}.tags[data-astro-cid-v3cnrnum]{display:flex;flex-wrap:wrap;gap:.5rem;justify-content:center;margin-block-start:.5rem}.tag[data-astro-cid-v3cnrnum]{background-color:var(--color-theme);color:#fff;padding:.2rem .5rem;border-radius:4px;font-size:.8rem}
</style>
<link rel="stylesheet" href="/_astro/_id_.CXLwv1yp.css"></head> <body> <div id="js-languageSuggest" data-astro-cid-onlux7ho> <a id="js-link" href="#" data-astro-cid-onlux7ho> <span class="material-icons-sharp" data-astro-cid-onlux7ho>autorenew</span> <span id="js-linkText" data-astro-cid-onlux7ho></span> </a> <button id="js-close" data-astro-cid-onlux7ho> <span class="material-icons-sharp" data-astro-cid-onlux7ho>close</span> </button> </div> <script>(function(){const currentLocale = "en";
const LOCALES = {"en":{"label":"English","lang":"en-US"},"zh-cn":{"label":"简体中文","lang":"zh-CN"}};

  const browserLang = navigator.language.toLowerCase();
  const suggest = document.getElementById("js-languageSuggest");

  const showSuggest = (lang) => {
    const pathnames = location.pathname.split("/");
    const link = document.getElementById("js-link");
    const linkText = document.getElementById("js-linkText");
    pathnames[1] = lang;
    link.href = pathnames.join("/");
    linkText.innerText = LOCALES[lang].label;
    suggest.style.display = "block";
  };

  if (
    currentLocale === browserLang ||
    currentLocale === browserLang.split("-")[0] ||
    localStorage.languageSuggestDenied ||
    localStorage.selectedLang
  ) {
    return;
  } else if (Object.keys(LOCALES).includes(browserLang)) {
    showSuggest(browserLang);
  } else if (Object.keys(LOCALES).includes(browserLang.split("-")[0])) {
    showSuggest(browserLang.split("-")[0]);
  }

  document.getElementById("js-close").addEventListener("click", () => {
    suggest.style.display = "none";
    localStorage.languageSuggestDenied = true;
  });
})();</script>  <header class="l-header" data-astro-cid-3ef6ksr2> <h1 dir="ltr" data-astro-cid-3ef6ksr2> <a href="/en/" data-astro-cid-3ef6ksr2>Nao&#39;s Blog</a> </h1> <label data-astro-cid-opxux4jt> <span class="material-icons-sharp" data-astro-cid-opxux4jt>translate</span> <select data-languageSelect data-astro-cid-opxux4jt> <option label="English" value="/en/blog/api-automation-testing/supertest-tutorial-advance-usage-multiple-environment-support/" data-lang="en" selected data-astro-cid-opxux4jt></option><option label="简体中文" value="/zh-cn/blog/api-automation-testing/supertest-tutorial-advance-usage-multiple-environment-support/" data-lang="zh-cn" data-astro-cid-opxux4jt></option> </select> <span class="material-icons-sharp" data-astro-cid-opxux4jt>expand_more</span> </label> <script>
  const selects = document.querySelectorAll("[data-languageSelect]");
  selects.forEach((select) => {
    select.addEventListener("change", (event) => {
      localStorage.selectedLang = event.target?.selectedOptions[0].dataset.lang;
      location.href = event.target?.value;
    });
  });
</script>  <nav class="l-content" data-astro-cid-3ef6ksr2> <ul data-astro-cid-3ef6ksr2> <li data-astro-cid-3ef6ksr2> <a href="/en/" data-astro-cid-3ef6ksr2> Home </a> </li> <li data-astro-cid-3ef6ksr2> <a href="/en/blog/" data-astro-cid-3ef6ksr2> Blog </a> </li> <li data-astro-cid-3ef6ksr2> <a href="/en/archive/" data-astro-cid-3ef6ksr2> Archive </a> </li> <li data-astro-cid-3ef6ksr2> <a href="/en/projects/" data-astro-cid-3ef6ksr2> Projects </a> </li> <li data-astro-cid-3ef6ksr2> <a href="/en/about/" data-astro-cid-3ef6ksr2> About </a> </li> <li data-astro-cid-3ef6ksr2> <a href="https://github.com/naodeng/naodeng.com.cn" target="_blank" data-astro-cid-3ef6ksr2>
GitHub
<span class="material-icons-sharp dir" data-astro-cid-3ef6ksr2>open_in_new</span> </a> </li> </ul> </nav> </header>  <main class="l-main l-content">  <article data-astro-cid-uwv4mmhs> <img src="/_astro/supertest-tutorial-advance-usage-multiple-environment-support-cover.C44kPaBL_2i38wD.webp" alt="SuperTest API Automation Testing Tutorial Advance Usage - Multiple Environment Support" data-astro-cid-v3cnrnum="true" loading="lazy" decoding="async" fetchpriority="auto" width="1200" height="630" class="cover"><header data-astro-cid-v3cnrnum> <h1 data-astro-cid-v3cnrnum>SuperTest API Automation Testing Tutorial Advance Usage - Multiple Environment Support</h1> <time datetime="2023-11-10T04:37:59.000Z" data-astro-cid-v3cnrnum> 11/10/2023 </time> <div class="tags" data-astro-cid-v3cnrnum> <span class="tag" data-astro-cid-v3cnrnum>Supertest</span><span class="tag" data-astro-cid-v3cnrnum>API Testing</span> </div> </header> <h2 id="multiple-environment-support">Multiple Environment Support</h2>
<p>When using Jest or Mocha for API testing, you may need to support testing different environments, such as development, test and production environments. This can be achieved by configuring different test scripts and environment variables.</p>
<p>The following is a brief description of how to configure multi-environment support in Jest and Mocha, with a demo demonstrating support for two environments.</p>
<p>Mocha version can be found in the demo project: <a href="https://github.com/Automation-Test-Starter/SuperTest-Mocha-demo">https://github.com/Automation-Test-Starter/SuperTest-Mocha-demo</a>.</p>
<p>The Jest version can be found in the demo project: <a href="https://github.com/Automation-Test-Starter/SuperTest-Jest-demo">https://github.com/Automation-Test-Starter/SuperTest-Jest-demo</a>.</p>
<blockquote>
<p>The mocha version is similar to the Jest version, so here is an example of the mocha version.</p>
</blockquote>
<h3 id="create-multi-environment-test-configuration-file">Create Multi-Environment Test Configuration File</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> configuration</span><span style="color:#9ECBFF"> folder,</span><span style="color:#9ECBFF"> if</span><span style="color:#9ECBFF"> already</span><span style="color:#9ECBFF"> exists,</span><span style="color:#9ECBFF"> skip</span><span style="color:#9ECBFF"> this</span><span style="color:#9ECBFF"> step</span></span>
<span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#9ECBFF"> Config</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> configuration</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#79B8FF">cd</span><span style="color:#9ECBFF"> Config</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> testConfig-test.js</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> configuration</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dev</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> testConfig-dev.js</span></span></code></pre>
<h3 id="edit-multi-environment-test-configuration-file">Edit Multi-Environment Test Configuration File</h3>
<ul>
<li>edit test configuration file for test environment: testConfig-test.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit test configuration file for test environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test config file for test environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    host: </span><span style="color:#9ECBFF">&#39;https://jsonplaceholder.typicode.com&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// Test endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: </span><span style="color:#9ECBFF">&#39;/posts/1&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// Test GET API URL</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI: </span><span style="color:#9ECBFF">&#39;/posts&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// Test POST API URL</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<ul>
<li>edit test configuration file for dev environment: testConfig-dev.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit test configuration file for dev environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test config file for dev environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    host: </span><span style="color:#9ECBFF">&#39;https://jsonplaceholder.typicode.com&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// Test endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: </span><span style="color:#9ECBFF">&#39;/posts/1&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// Test GET API URL</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI: </span><span style="color:#9ECBFF">&#39;/posts&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// Test POST API URL</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="create-multi-environment-test-data-file">Create Multi-Environment Test Data File</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> folder,</span><span style="color:#9ECBFF"> if</span><span style="color:#9ECBFF"> already</span><span style="color:#9ECBFF"> exists,</span><span style="color:#9ECBFF"> skip</span><span style="color:#9ECBFF"> this</span><span style="color:#9ECBFF"> step</span></span>
<span class="line"><span style="color:#B392F0">mkdir</span><span style="color:#9ECBFF"> testData</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> enter</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> folder</span></span>
<span class="line"><span style="color:#79B8FF">cd</span><span style="color:#9ECBFF"> testData</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> request</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> requestData-test.js</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> response</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> test</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> responseData-test.js</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> request</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dev</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> requestData-dev.js</span></span>
<span class="line"><span style="color:#B392F0">//</span><span style="color:#9ECBFF"> create</span><span style="color:#9ECBFF"> response</span><span style="color:#9ECBFF"> data</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> for</span><span style="color:#9ECBFF"> dev</span><span style="color:#9ECBFF"> environment</span></span>
<span class="line"><span style="color:#B392F0">touch</span><span style="color:#9ECBFF"> responseData-dev.js</span></span></code></pre>
<h3 id="edit-multi-environment-test-data-file">Edit Multi-Environment Test Data File</h3>
<ul>
<li>edit request data file for test environment: requestData-test.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit request data file for test environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test request data file for test environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: </span><span style="color:#9ECBFF">&#39;&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// request data for GET API</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI:{</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;foo&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;bar&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// request data for POST API</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<ul>
<li>edit response data file for test environment: responseData-test.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit response data file for test environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test response data file for test environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: {</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;id&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;quia et suscipit</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">suscipit recusandae consequuntur expedita et cum</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">reprehenderit molestiae ut ut quas totam</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">nostrum rerum est autem sunt rem eveniet architecto&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// response data for GET API</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI:{</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;foo&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;bar&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;id&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">101</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// response data for POST API</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<ul>
<li>edit request data file for dev environment: requestData-dev.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit request data file for dev environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test request data file for dev environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: </span><span style="color:#9ECBFF">&#39;&#39;</span><span style="color:#E1E4E8">,  </span><span style="color:#6A737D">// request data for GET API</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI:{</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;foo&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;bar&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// request data for POST API</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<ul>
<li>edit response data file for dev environment: responseData-dev.js</li>
</ul>
<blockquote>
<p>based on actual situation, edit response data file for dev environment</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test response data file for dev environment</span></span>
<span class="line"><span style="color:#79B8FF">module</span><span style="color:#E1E4E8">.</span><span style="color:#79B8FF">exports</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    getAPI: {</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;id&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;quia et suscipit</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">suscipit recusandae consequuntur expedita et cum</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">reprehenderit molestiae ut ut quas totam</span><span style="color:#79B8FF">\n</span><span style="color:#9ECBFF">nostrum rerum est autem sunt rem eveniet architecto&quot;</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// response data for GET API</span></span>
<span class="line"><span style="color:#E1E4E8">    postAPI:{</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;title&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;foo&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;body&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;bar&quot;</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;userId&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#9ECBFF">        &quot;id&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#79B8FF">101</span></span>
<span class="line"><span style="color:#E1E4E8">    },  </span><span style="color:#6A737D">// response data for POST API</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<h3 id="update-test-cases-to-support-multiple-environments">Update test cases to support multiple environments</h3>
<blockquote>
<p>To differentiate, here is a new test case file named multiEnvTest.spec.js</p>
</blockquote>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#6A737D">// Test: multiEnvTest.spec.js</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> request</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;supertest&#39;</span><span style="color:#E1E4E8">); </span><span style="color:#6A737D">// import supertest</span></span>
<span class="line"><span style="color:#B392F0">require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;chai&#39;</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#6A737D">// import chai</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> expect</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;chai&#39;</span><span style="color:#E1E4E8">).expect; </span><span style="color:#6A737D">// import expect</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> config</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> process.env.</span><span style="color:#79B8FF">NODE_ENV</span><span style="color:#F97583"> ===</span><span style="color:#9ECBFF"> &#39;test&#39;</span><span style="color:#F97583"> ?</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../Config/testConfig-test&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">:</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../Config/testConfig-dev&#39;</span><span style="color:#E1E4E8">); </span><span style="color:#6A737D">// import test config</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> requestData</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> process.env.</span><span style="color:#79B8FF">NODE_ENV</span><span style="color:#F97583"> ===</span><span style="color:#9ECBFF"> &#39;test&#39;</span><span style="color:#F97583"> ?</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../TestData/requestData-test&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">:</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../TestData/requestData-dev&#39;</span><span style="color:#E1E4E8">); </span><span style="color:#6A737D">// import request data</span></span>
<span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> responseData</span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> process.env.</span><span style="color:#79B8FF">NODE_ENV</span><span style="color:#F97583"> ===</span><span style="color:#9ECBFF"> &#39;test&#39;</span><span style="color:#F97583"> ?</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../TestData/responseData-test&#39;</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">:</span><span style="color:#B392F0"> require</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;../TestData/responseData-dev&#39;</span><span style="color:#E1E4E8">); </span><span style="color:#6A737D">// import response data</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// Test Suite</span></span>
<span class="line"><span style="color:#B392F0">describe</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;multiEnv-Verify that the Get and POST API returns correctly&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">function</span><span style="color:#E1E4E8">(){</span></span>
<span class="line"><span style="color:#6A737D">    // Test case 1</span></span>
<span class="line"><span style="color:#B392F0">    it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;multiEnv-Verify that the GET API returns correctly&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">done</span><span style="color:#E1E4E8">){</span></span>
<span class="line"><span style="color:#B392F0">        request</span><span style="color:#E1E4E8">(config.host) </span><span style="color:#6A737D">// Test endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">get</span><span style="color:#E1E4E8">(config.getAPI) </span><span style="color:#6A737D">// API endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">expect</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">200</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D">// expected response status code</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">expect</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.id).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.getAPI.id)</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.userId).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.getAPI.userId)</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.title).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.getAPI.title)</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.body).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.getAPI.body)</span></span>
<span class="line"><span style="color:#E1E4E8">            }) </span><span style="color:#6A737D">// expected response body</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">end</span><span style="color:#E1E4E8">(done) </span><span style="color:#6A737D">// end the test case</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#6A737D">    // Test case 2</span></span>
<span class="line"><span style="color:#B392F0">    it</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&#39;multiEnv-Verify that the POST API returns correctly&#39;</span><span style="color:#E1E4E8">, </span><span style="color:#F97583">function</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">done</span><span style="color:#E1E4E8">){</span></span>
<span class="line"><span style="color:#B392F0">        request</span><span style="color:#E1E4E8">(config.host) </span><span style="color:#6A737D">// Test endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">post</span><span style="color:#E1E4E8">(config.postAPI) </span><span style="color:#6A737D">// API endpoint</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">send</span><span style="color:#E1E4E8">(requestData.postAPI) </span><span style="color:#6A737D">// request body</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">expect</span><span style="color:#E1E4E8">(</span><span style="color:#79B8FF">201</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D">// expected response status code</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">expect</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">function</span><span style="color:#E1E4E8"> (</span><span style="color:#FFAB70">res</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.id).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.postAPI.id )</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.userId).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.postAPI.userId )</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.title).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.postAPI.title )</span></span>
<span class="line"><span style="color:#B392F0">                expect</span><span style="color:#E1E4E8">(res.body.body).to.</span><span style="color:#B392F0">equal</span><span style="color:#E1E4E8">(responseData.postAPI.body )</span></span>
<span class="line"><span style="color:#E1E4E8">            }) </span><span style="color:#6A737D">// expected response body</span></span>
<span class="line"><span style="color:#E1E4E8">            .</span><span style="color:#B392F0">end</span><span style="color:#E1E4E8">(done) </span><span style="color:#6A737D">// end the test case</span></span>
<span class="line"><span style="color:#E1E4E8">    });</span></span>
<span class="line"><span style="color:#E1E4E8">});</span></span></code></pre>
<h3 id="update-test-scripts-to-support-multiple-environments">Update test scripts to support multiple environments</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="json"><code><span class="line"><span style="color:#6A737D">// package.json</span></span>
<span class="line"><span style="color:#9ECBFF">&quot;scripts&quot;</span><span style="color:#E1E4E8">: {</span></span>
<span class="line"><span style="color:#79B8FF">    &quot;test&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;NODE_ENV=test mocha&quot;</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// run test script for test environment</span></span>
<span class="line"><span style="color:#79B8FF">    &quot;dev&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;NODE_ENV=dev mocha&quot;</span><span style="color:#6A737D"> //  run test script for dev environment</span></span>
<span class="line"><span style="color:#E1E4E8">  },</span></span></code></pre>
<h3 id="run-the-test-case-to-check-if-the-multi-environment-support-is-working">Run the test case to check if the multi environment support is working.</h3>
<blockquote>
<p>If you use demo project to run multi-environment support test case: multiEnvTest.spec.js, it is recommended to block dataDrivingTest.spec.js and test.spec.js test cases first, otherwise it will report an error.</p>
</blockquote>
<ul>
<li>Run the test environment test script</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> run</span><span style="color:#9ECBFF"> test</span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/OMbN1v.png" alt="OMbN1v"/></p>
<ul>
<li>Run the dev environment test script</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">npm</span><span style="color:#9ECBFF"> run</span><span style="color:#9ECBFF"> dev</span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/mWzei1.png" alt="mWzei1"/></p>  </article>  </main> <footer class="l-footer l-content" data-astro-cid-sz7xmlte> <a href="https://github.com/naodeng/naodeng.com.cn" target="_blank" class="github" data-astro-cid-sz7xmlte>
GitHub
<span class="material-icons-sharp dir" data-astro-cid-sz7xmlte>open_in_new</span> </a> <ul data-astro-cid-sz7xmlte> <li><a href="/en/" onclick="localStorage.selectedLang = &#34;en&#34;" lang="en">English</a></li><li><a href="/zh-cn/" onclick="localStorage.selectedLang = &#34;zh-cn&#34;" lang="zh-cn">简体中文</a></li> </ul> <a class="copy" href="https://naodeng.com.cn/" target="_blank" dir="ltr" data-astro-cid-sz7xmlte>
© Nao Deng 2026 </a> </footer>   </body> </html>  