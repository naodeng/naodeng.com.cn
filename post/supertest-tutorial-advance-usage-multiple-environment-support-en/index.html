<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>SuperTest Tutorial Advance Usage - Multiple Environment Support |
Nao
</title><meta charset=utf-8><meta name=generator content="Hugo 0.120.4"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content="Nao"><meta name=description content="This blog focuses on advanced usage of SuperTest with an emphasis on multi-environment support. You will learn how to configure and manage multiple test environments for different stages of development and deployment. We will discuss how to easily switch between different environments within the same test suite to ensure that your API tests run stably in a variety of situations. This tutorial will help you better organize and maintain your test code, improve test coverage, and ensure test adaptability and reliability. Whether you are a beginner or an experienced tester, this blog will provide you with valuable information that will enable you to be more flexible in meeting the challenges of supporting multiple environments."><meta name=google-site-verification content="google5e9a7c9479924ed2"><link rel=stylesheet href=/scss/main.min.772eefee9824c26da5d3828c2507ea318c8e7a37b0b1d18cd4f224edc2755fea.css integrity="sha256-dy7v7pgkwm2l04KMJQfqMYyOejewsdGM1PIk7cJ1X+o=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=canonical href=https://naodeng.tech/post/supertest-tutorial-advance-usage-multiple-environment-support-en/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script><script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><script async defer src=https://naodeng-umami.vercel.app/hugo.js data-website-id=b3b285c9-3c35-4398-9252-91bb70560b84></script><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://naodeng.tech/images/site-feature-image.png"><meta name=twitter:title content="SuperTest Tutorial Advance Usage - Multiple Environment Support"><meta name=twitter:description content="This blog focuses on advanced usage of SuperTest with an emphasis on multi-environment support. You will learn how to configure and manage multiple test environments for different stages of development and deployment. We will discuss how to easily switch between different environments within the same test suite to ensure that your API tests run stably in a variety of situations. This tutorial will help you better organize and maintain your test code, improve test coverage, and ensure test adaptability and reliability. Whether you are a beginner or an experienced tester, this blog will provide you with valuable information that will enable you to be more flexible in meeting the challenges of supporting multiple environments."><meta property="og:title" content="SuperTest Tutorial Advance Usage - Multiple Environment Support"><meta property="og:description" content="This blog focuses on advanced usage of SuperTest with an emphasis on multi-environment support. You will learn how to configure and manage multiple test environments for different stages of development and deployment. We will discuss how to easily switch between different environments within the same test suite to ensure that your API tests run stably in a variety of situations. This tutorial will help you better organize and maintain your test code, improve test coverage, and ensure test adaptability and reliability. Whether you are a beginner or an experienced tester, this blog will provide you with valuable information that will enable you to be more flexible in meeting the challenges of supporting multiple environments."><meta property="og:type" content="article"><meta property="og:url" content="https://naodeng.tech/post/supertest-tutorial-advance-usage-multiple-environment-support-en/"><meta property="og:image" content="https://naodeng.tech/images/site-feature-image.png"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-11-10T12:37:59+08:00"><meta property="article:modified_time" content="2023-11-10T12:37:59+08:00"><meta property="og:site_name" content="QA Discovery"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"post","name":"SuperTest Tutorial Advance Usage - Multiple Environment Support","headline":"SuperTest Tutorial Advance Usage - Multiple Environment Support","alternativeHeadline":"","description":"
      This blog focuses on advanced usage of SuperTest with an emphasis on multi-environment support. You will learn how to configure and manage multiple test environments for different stages of development and deployment. We will discuss how to easily switch between different environments within the same test suite to ensure that your API tests run stably in a variety of situations. This tutorial will help you better organize and maintain your test code, improve test coverage, and ensure test adaptability and reliability. Whether you are a beginner or an experienced tester, this blog will provide you with valuable information that will enable you to be more flexible in meeting the challenges of supporting multiple environments.


    ","inLanguage":"en","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/naodeng.tech\/post\/supertest-tutorial-advance-usage-multiple-environment-support-en\/"},"author":{"@type":"Person","name":"nao.deng"},"creator":{"@type":"Person","name":"nao.deng"},"accountablePerson":{"@type":"Person","name":"nao.deng"},"copyrightHolder":{"@type":"Person","name":"nao.deng"},"copyrightYear":"2023","dateCreated":"2023-11-10T12:37:59.00Z","datePublished":"2023-11-10T12:37:59.00Z","dateModified":"2023-11-10T12:37:59.00Z","publisher":{"@type":"Organization","name":"nao.deng","url":"https://naodeng.tech/","logo":{"@type":"ImageObject","url":"https:\/\/naodeng.tech\/favicon-32x32.png","width":"32","height":"32"}},"image":["https://naodeng.tech/images/site-feature-image.png"],"url":"https:\/\/naodeng.tech\/post\/supertest-tutorial-advance-usage-multiple-environment-support-en\/","wordCount":"888","genre":["API automation testing","SuperTest"],"keywords":["Data Driven"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src="https://avatars.githubusercontent.com/u/7599466?v=4" alt="profile picture"><div class=sidebar__introduction-title><a href=/>QA Discovery</a></div><div class=sidebar__introduction-description><p>A Quality Analyst, Not A Quality Assurance</p></div></div><ul class=sidebar__list><li class=sidebar__list-item><a href=https://github.com/naodeng/ target=_blank rel="noopener me" aria-label=GitHub title=GitHub><i class="fab fa-github fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=https://naodeng.medium.com/ target=_blank rel="noopener me" aria-label=medium title=medium><i class="fab fa-medium fa-2x" aria-hidden=true></i></a></li><li class=sidebar__list-item><a href=mailto:dengnao@gmail.com target=_blank rel="noopener me" aria-label=e-mail title=e-mail><i class="fas fa-envelope fa-2x" aria-hidden=true></i></a></li></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
2015-2023 naodeng ï½œ wechat: teststudents</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JBX883ZDJJ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JBX883ZDJJ",{anonymize_ip:!1})}</script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu><li class=nav__list-item><a href=/ title>Home</a></li><li class=nav__list-item><a href=/post/ title>Posts</a></li><li class=nav__list-item><a href=/categories/ title>Categories</a></li><li class=nav__list-item><a href=/tags/ title>Tags</a></li><li class=nav__list-item><a href=https://github.com/naodeng/naodeng target=_blank rel="noopener noreferrer" title>About</a></li><li class=nav__list-item><a href=https://naodeng-umami.vercel.app/share/OksEL34H/nao.deng target=_blank rel="noopener noreferrer" title>Dashboard</a></li></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>SuperTest Tutorial Advance Usage - Multiple Environment Support</h1><ul class=post__meta><li class=post__meta-item><em class="fas fa-calendar-day post__meta-icon"></em>
<span class=post__meta-text>Fri, Nov 10, 2023</span></li><li class=post__meta-item><em class="fas fa-stopwatch post__meta-icon"></em>
<span class=post__meta-text>5-minute read</span></li></ul><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#multiple-environment-support>Multiple Environment Support</a><ul><li><a href=#create-multi-environment-test-configuration-file>Create Multi-Environment Test Configuration File</a></li><li><a href=#edit-multi-environment-test-configuration-file>Edit Multi-Environment Test Configuration File</a></li><li><a href=#create-multi-environment-test-data-file>Create Multi-Environment Test Data File</a></li><li><a href=#edit-multi-environment-test-data-file>Edit Multi-Environment Test Data File</a></li><li><a href=#update-test-cases-to-support-multiple-environments>Update test cases to support multiple environments</a></li><li><a href=#update-test-scripts-to-support-multiple-environments>Update test scripts to support multiple environments</a></li><li><a href=#run-the-test-case-to-check-if-the-multi-environment-support-is-working>Run the test case to check if the multi environment support is working.</a></li></ul></li></ul></nav><h2 id=multiple-environment-support>Multiple Environment Support</h2><p>When using Jest or Mocha for API testing, you may need to support testing different environments, such as development, test and production environments. This can be achieved by configuring different test scripts and environment variables.</p><p>The following is a brief description of how to configure multi-environment support in Jest and Mocha, with a demo demonstrating support for two environments.</p><p>Mocha version can be found in the demo project: <a href=https://github.com/Automation-Test-Starter/SuperTest-Mocha-demo>https://github.com/Automation-Test-Starter/SuperTest-Mocha-demo</a>.</p><p>The Jest version can be found in the demo project: <a href=https://github.com/Automation-Test-Starter/SuperTest-Jest-demo>https://github.com/Automation-Test-Starter/SuperTest-Jest-demo</a>.</p><blockquote><p>The mocha version is similar to the Jest version, so here is an example of the mocha version.</p></blockquote><h3 id=create-multi-environment-test-configuration-file>Create Multi-Environment Test Configuration File</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>// create <span class=nb>test</span> configuration folder, <span class=k>if</span> already exists, skip this step
</span></span><span class=line><span class=cl>mkdir Config
</span></span><span class=line><span class=cl>// create <span class=nb>test</span> configuration file <span class=k>for</span> <span class=nb>test</span> environment
</span></span><span class=line><span class=cl><span class=nb>cd</span> Config
</span></span><span class=line><span class=cl>touch testConfig-test.js
</span></span><span class=line><span class=cl>// create <span class=nb>test</span> configuration file <span class=k>for</span> dev environment
</span></span><span class=line><span class=cl>touch testConfig-dev.js
</span></span></code></pre></div><h3 id=edit-multi-environment-test-configuration-file>Edit Multi-Environment Test Configuration File</h3><ul><li>edit test configuration file for test environment: testConfig-test.js</li></ul><blockquote><p>based on actual situation, edit test configuration file for test environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test config file for test environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>host</span><span class=o>:</span> <span class=s1>&#39;https://jsonplaceholder.typicode.com&#39;</span><span class=p>,</span>  <span class=c1>// Test endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>getAPI</span><span class=o>:</span> <span class=s1>&#39;/posts/1&#39;</span><span class=p>,</span>  <span class=c1>// Test GET API URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span> <span class=s1>&#39;/posts&#39;</span><span class=p>,</span> <span class=c1>// Test POST API URL
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><ul><li>edit test configuration file for dev environment: testConfig-dev.js</li></ul><blockquote><p>based on actual situation, edit test configuration file for dev environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test config file for dev environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>host</span><span class=o>:</span> <span class=s1>&#39;https://jsonplaceholder.typicode.com&#39;</span><span class=p>,</span>  <span class=c1>// Test endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>getAPI</span><span class=o>:</span> <span class=s1>&#39;/posts/1&#39;</span><span class=p>,</span>  <span class=c1>// Test GET API URL
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span> <span class=s1>&#39;/posts&#39;</span><span class=p>,</span> <span class=c1>// Test POST API URL
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><h3 id=create-multi-environment-test-data-file>Create Multi-Environment Test Data File</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>// create <span class=nb>test</span> data folder, <span class=k>if</span> already exists, skip this step
</span></span><span class=line><span class=cl>mkdir testData
</span></span><span class=line><span class=cl>// enter <span class=nb>test</span> data folder
</span></span><span class=line><span class=cl><span class=nb>cd</span> testData
</span></span><span class=line><span class=cl>// create request data file <span class=k>for</span> <span class=nb>test</span> environment
</span></span><span class=line><span class=cl>touch requestData-test.js
</span></span><span class=line><span class=cl>// create response data file <span class=k>for</span> <span class=nb>test</span> environment
</span></span><span class=line><span class=cl>touch responseData-test.js
</span></span><span class=line><span class=cl>// create request data file <span class=k>for</span> dev environment
</span></span><span class=line><span class=cl>touch requestData-dev.js
</span></span><span class=line><span class=cl>// create response data file <span class=k>for</span> dev environment
</span></span><span class=line><span class=cl>touch responseData-dev.js
</span></span></code></pre></div><h3 id=edit-multi-environment-test-data-file>Edit Multi-Environment Test Data File</h3><ul><li>edit request data file for test environment: requestData-test.js</li></ul><blockquote><p>based on actual situation, edit request data file for test environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test request data file for test environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>getAPI</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>  <span class=c1>// request data for GET API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// request data for POST API
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><ul><li>edit response data file for test environment: responseData-test.js</li></ul><blockquote><p>based on actual situation, edit response data file for test environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test response data file for test environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>getAPI</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// response data for GET API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=mi>101</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// response data for POST API
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><ul><li>edit request data file for dev environment: requestData-dev.js</li></ul><blockquote><p>based on actual situation, edit request data file for dev environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test request data file for dev environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>getAPI</span><span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span>  <span class=c1>// request data for GET API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// request data for POST API
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><ul><li>edit response data file for dev environment: responseData-dev.js</li></ul><blockquote><p>based on actual situation, edit response data file for dev environment</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test response data file for dev environment
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>module</span><span class=p>.</span><span class=nx>exports</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>getAPI</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;sunt aut facere repellat provident occaecati excepturi optio reprehenderit&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// response data for GET API
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>postAPI</span><span class=o>:</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;title&#34;</span><span class=o>:</span> <span class=s2>&#34;foo&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;body&#34;</span><span class=o>:</span> <span class=s2>&#34;bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;userId&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=mi>101</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>  <span class=c1>// response data for POST API
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span></code></pre></div><h3 id=update-test-cases-to-support-multiple-environments>Update test cases to support multiple environments</h3><blockquote><p>To differentiate, here is a new test case file named multiEnvTest.spec.js</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// Test: multiEnvTest.spec.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>request</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;supertest&#39;</span><span class=p>);</span> <span class=c1>// import supertest
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>require</span><span class=p>(</span><span class=s1>&#39;chai&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=c1>// import chai
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>expect</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;chai&#39;</span><span class=p>).</span><span class=nx>expect</span><span class=p>;</span> <span class=c1>// import expect
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>config</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>NODE_ENV</span> <span class=o>===</span> <span class=s1>&#39;test&#39;</span> <span class=o>?</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../Config/testConfig-test&#39;</span><span class=p>)</span> <span class=o>:</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../Config/testConfig-dev&#39;</span><span class=p>);</span> <span class=c1>// import test config
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>requestData</span> <span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>NODE_ENV</span> <span class=o>===</span> <span class=s1>&#39;test&#39;</span> <span class=o>?</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../TestData/requestData-test&#39;</span><span class=p>)</span> <span class=o>:</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../TestData/requestData-dev&#39;</span><span class=p>);</span> <span class=c1>// import request data
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>responseData</span><span class=o>=</span> <span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>NODE_ENV</span> <span class=o>===</span> <span class=s1>&#39;test&#39;</span> <span class=o>?</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../TestData/responseData-test&#39;</span><span class=p>)</span> <span class=o>:</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;../TestData/responseData-dev&#39;</span><span class=p>);</span> <span class=c1>// import response data
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>// Test Suite
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nx>describe</span><span class=p>(</span><span class=s1>&#39;multiEnv-Verify that the Get and POST API returns correctly&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Test case 1
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;multiEnv-Verify that the GET API returns correctly&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>done</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nx>request</span><span class=p>(</span><span class=nx>config</span><span class=p>.</span><span class=nx>host</span><span class=p>)</span> <span class=c1>// Test endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>config</span><span class=p>.</span><span class=nx>getAPI</span><span class=p>)</span> <span class=c1>// API endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>expect</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span> <span class=c1>// expected response status code
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>expect</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>id</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>getAPI</span><span class=p>.</span><span class=nx>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>userId</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>getAPI</span><span class=p>.</span><span class=nx>userId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>title</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>getAPI</span><span class=p>.</span><span class=nx>title</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>body</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>getAPI</span><span class=p>.</span><span class=nx>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span> <span class=c1>// expected response body
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=c1>// end the test case
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Test case 2
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>it</span><span class=p>(</span><span class=s1>&#39;multiEnv-Verify that the POST API returns correctly&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>done</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nx>request</span><span class=p>(</span><span class=nx>config</span><span class=p>.</span><span class=nx>host</span><span class=p>)</span> <span class=c1>// Test endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=nx>config</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>)</span> <span class=c1>// API endpoint
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>send</span><span class=p>(</span><span class=nx>requestData</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>)</span> <span class=c1>// request body
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>expect</span><span class=p>(</span><span class=mi>201</span><span class=p>)</span> <span class=c1>// expected response status code
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>expect</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>res</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>id</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>.</span><span class=nx>id</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>userId</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>.</span><span class=nx>userId</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>title</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>.</span><span class=nx>title</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=nx>expect</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>body</span><span class=p>).</span><span class=nx>to</span><span class=p>.</span><span class=nx>equal</span><span class=p>(</span><span class=nx>responseData</span><span class=p>.</span><span class=nx>postAPI</span><span class=p>.</span><span class=nx>body</span> <span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span> <span class=c1>// expected response body
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=p>.</span><span class=nx>end</span><span class=p>(</span><span class=nx>done</span><span class=p>)</span> <span class=c1>// end the test case
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><h3 id=update-test-scripts-to-support-multiple-environments>Update test scripts to support multiple environments</h3><p>&lsquo;&lsquo;&lsquo;json
// package.json
&ldquo;scripts&rdquo;: {
&ldquo;test&rdquo;: &ldquo;NODE_ENV=test mocha&rdquo; // run test script for test environment
&ldquo;dev&rdquo;: &ldquo;NODE_ENV=dev mocha&rdquo; // run test script for dev environment
},
&rsquo;&rsquo;&rsquo;</p><h3 id=run-the-test-case-to-check-if-the-multi-environment-support-is-working>Run the test case to check if the multi environment support is working.</h3><blockquote><p>If you use demo project to run multi-environment support test case: multiEnvTest.spec.js, it is recommended to block dataDrivingTest.spec.js and test.spec.js test cases first, otherwise it will report an error.</p></blockquote><ul><li>Run the test environment test script</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm run <span class=nb>test</span>
</span></span></code></pre></div><p><img src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/OMbN1v.png alt=OMbN1v></p><ul><li>Run the dev environment test script</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>npm run dev
</span></span></code></pre></div><p><img src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/mWzei1.png alt=mWzei1></p><h3>Related Posts</h3><ul><li><a href=/post/supertest-tutorial-advance-usage-data-driven-en/>SuperTest Tutorial Advance Usage - Data Driven</a></li><li><a href=/post/supertest-tutorial-advance-usage-common-assertions-en/>SuperTest Tutorial: Advanced Usage - Common Assertions</a></li><li><a href=/post/supertest-tutorial-advance-usage-integration-ci-cd-and-github-action-en/>SuperTest Tutorial: Advanced Usage - Integration CI CD and Github action</a></li><li><a href=/post/supertest-tutorial-building-your-own-project-from-0-to-1-en/>SuperTest Tutorial: Building a Supertest API Automation Test project from 0 to 1</a></li></ul></div><div class=post__footer><span><a class=category href=/categories/api-automation-testing/>API automation testing</a><a class=category href=/categories/supertest/>SuperTest</a></span>
<span><a class=tag href=/tags/data-driven/>Data Driven</a></span></div><div id=comment><h2>comments</h2><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//naodeng-tech.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
2015-2023 naodeng ï½œ wechat: teststudents</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JBX883ZDJJ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JBX883ZDJJ",{anonymize_ip:!1})}</script></body></html>