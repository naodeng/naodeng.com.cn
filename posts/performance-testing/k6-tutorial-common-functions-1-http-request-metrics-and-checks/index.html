<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks | Nao's Blog</title>
<meta name=keywords content="Common Functions,HTTP request,metrics,checks"><meta name=description content="The article provides a detailed exploration of the HTTP request functionality in K6, dissecting common performance metrics and check features. Learn how to leverage K6 for robust performance testing, simulating user behavior through HTTP requests, and assessing system response by understanding performance metrics. The tutorial delves into configuring and executing checks, ensuring performance aligns with expected standards. Whether you&rsquo;re a beginner or an experienced performance testing professional, this guide equips you with practical knowledge to harness the full potential of K6 in performance testing. Click the link to embark on an efficient journey into performance testing with K6!"><meta name=author content="nao.deng"><link rel=canonical href=https://naodeng.com.cn/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/><meta name=google-site-verification content="google5e9a7c9479924ed2"><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://naodeng.com.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://naodeng.com.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://naodeng.com.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://naodeng.com.cn/apple-touch-icon.png><link rel=mask-icon href=https://naodeng.com.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://naodeng.com.cn/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/><link rel=alternate hreflang=zh href=https://naodeng.com.cn/zh/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta name=baidu-site-verification content="codeva-2siuZUJUWf"><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?93a34d905469b810e5bae990720e7139",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><script defer data-website-id=b3b285c9-3c35-4398-9252-91bb70560b84 src=https://naodeng-umami.vercel.app/hugo.js></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "baa460bb003847e184ad7cbf459449e9"}'></script><meta http-equiv=Content-Type content="text/html;charset=gb2312"><meta name=sogou_site_verification content="iwkYDJrzfK"><script async src="https://www.googletagmanager.com/gtag/js?id=G-JBX883ZDJJ"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JBX883ZDJJ",{anonymize_ip:!1})}</script><meta property="og:title" content="K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks"><meta property="og:description" content="The article provides a detailed exploration of the HTTP request functionality in K6, dissecting common performance metrics and check features. Learn how to leverage K6 for robust performance testing, simulating user behavior through HTTP requests, and assessing system response by understanding performance metrics. The tutorial delves into configuring and executing checks, ensuring performance aligns with expected standards. Whether you&rsquo;re a beginner or an experienced performance testing professional, this guide equips you with practical knowledge to harness the full potential of K6 in performance testing. Click the link to embark on an efficient journey into performance testing with K6!"><meta property="og:type" content="article"><meta property="og:url" content="https://naodeng.com.cn/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/"><meta property="og:image" content="https://naodeng.com.cn/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-01-11T17:10:00+08:00"><meta property="article:modified_time" content="2024-01-11T17:10:00+08:00"><meta property="og:see_also" content="https://naodeng.com.cn/posts/performance-testing/k6-tutorial-getting-started-and-your-first-k6-test-script/"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://naodeng.com.cn/papermod-cover.png"><meta name=twitter:title content="K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks"><meta name=twitter:description content="The article provides a detailed exploration of the HTTP request functionality in K6, dissecting common performance metrics and check features. Learn how to leverage K6 for robust performance testing, simulating user behavior through HTTP requests, and assessing system response by understanding performance metrics. The tutorial delves into configuring and executing checks, ensuring performance aligns with expected standards. Whether you&rsquo;re a beginner or an experienced performance testing professional, this guide equips you with practical knowledge to harness the full potential of K6 in performance testing. Click the link to embark on an efficient journey into performance testing with K6!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://naodeng.com.cn/posts/"},{"@type":"ListItem","position":2,"name":"K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks","item":"https://naodeng.com.cn/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks","name":"K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks","description":"The article provides a detailed exploration of the HTTP request functionality in K6, dissecting common performance metrics and check features. Learn how to leverage K6 for robust performance testing, simulating user behavior through HTTP requests, and assessing system response by understanding performance metrics. The tutorial delves into configuring and executing checks, ensuring performance aligns with expected standards. Whether you\u0026rsquo;re a beginner or an experienced performance testing professional, this guide equips you with practical knowledge to harness the full potential of K6 in performance testing. Click the link to embark on an efficient journey into performance testing with K6!","keywords":["Common Functions","HTTP request","metrics","checks"],"articleBody":"K6 common function HTTP Requests The first step in performance testing with K6 is to define the HTTP requests to be tested.\nGET Request Example A simple HTTP request for the GET method is already included in the demo test script created with the k6 new command:\nimport http from 'k6/http'; import { sleep } from 'k6'; export default function() { http.get('https://test.k6.io'); sleep(1); } POST Request Example This POST request example shows the application of some complex scenarios (POST request with email/password authentication load)\nimport http from 'k6/http'; export default function () { const url = 'http://test.k6.io/login'; const payload = JSON.stringify({ email: 'aaa', password: 'bbb', }); const params = { headers: { 'Content-Type': 'application/json', }, }; http.post(url, payload, params); } The above is taken from K6 Official Documentation\nSupported HTTP Methods The HTTP module provided by K6 can handle various HTTP requests and methods. The following is a list of supported HTTP methods:\nNAME VALUE batch() makes multiple HTTP requests in parallel (like e.g. browsers tend to do). del() makes an HTTP DELETE request. get() makes an HTTP GET request. head() makes an HTTP HEAD request. options() makes an HTTP OPTIONS request. patch() makes an HTTP PATCH request. post() makes an HTTP POST request. put() makes an HTTP PUT request. request() makes any type of HTTP request. HTTP Request Tags K6 allows you to add tags to each HTTP request. Combining tags and grouping makes it easy to better organize in test results, group requests and filter results to organize analysis.\nThe following is a list of supported tags:\nNAME DESCRIPTION expected_response By default, response statuses between 200 and 399 are true. Change the default behavior with setResponseCallback. group When the request runs inside a group, the tag value is the group name. Default is empty. name Defaults to URL requested method Request method (GET, POST, PUT etc.) scenario When the request runs inside a scenario, the tag value is the scenario name. Default is default. status response status url defaults to URL requested Examples of HTTP requests using tag and group tags will be shown in subsequent demos.\nYou can also refer to the official examples:https://grafana.com/docs/k6/latest/using-k6/http-requests/\nMetrics The metrics are used to measure the performance of the system under test conditions. By default, k6 automatically collects built-in metrics. In addition to the built-in metrics, you can create custom metrics.\nMetrics generally fall into four categories:\nCounters: Summing values. Gauges: Tracking the smallest, largest, and most recent values. Rates: Tracking how often non-zero values occur. Trends: Calculating statistical information (such as mean, mode, or percentile) for multiple values. To ensure that test assertions meet the criteria, thresholds can be written based on the conditions of the metrics required by the performance test (the specifics of the expression depend on the type of metric).\nFor subsequent filtering of metrics, labels and groupings can be used, allowing for better organization of test results.\nThe test results output file can export metrics in a variety of summary and fine-grained formats. For more information, refer to the results output documentation. (This section will be covered in more detail in the later part of the test results output documentation.)\nK6 Built-in Metrics Every k6 test execution emits both built-in and custom metrics. Each supported protocol also has its specific metrics.\nStandard Built-in Metrics Regardless of the protocol used in the test, k6 always collects the following metrics:\nMetric Name Type Description vus Gauge Current number of active virtual users vus_max Gauge Max possible number of virtual users (VU resources are pre-allocated, to avoid affecting performance when scaling up load ) iterations Counter The aggregate number of times the VUs execute the JS script (the default function). iteration_duration Trend The time to complete one full iteration, including time spent in setup and teardown. To calculate the duration of the iteration’s function for the specific scenario, try this workaround dropped_iterations Counter The number of iterations that weren’t started due to lack of VUs (for the arrival-rate executors) or lack of time (expired maxDuration in the iteration-based executors). About dropped iterations data_received Counter The amount of received data. This example covers how to track data for an individual URL. data_sent Counter The amount of data sent. Track data for an individual URL to track data for an individual URL. checks Rate The rate of successful checks. HTTP-specific built-in metrics HTTP-specific built-in metrics are generated only when the test makes HTTP requests.Other types of requests, such as WebSocket, do not generate these metrics.\nNote: For all http_req_* metrics, the timestamp is emitted at the end of the request. In other words, the timestamp occurs when k6 receives the end of the response body or when the request times out.\nThe following table lists HTTP-specific built-in metrics:\nMetric Name Type Description http_reqs Counter How many total HTTP requests k6 generated. http_req_blocked Trend Time spent blocked (waiting for a free TCP connection slot) before initiating the request. float http_req_connecting Trend Time spent establishing TCP connection to the remote host. float http_req_tls_handshaking Trend Time spent handshaking TLS session with remote host http_req_sending Trend Time spent sending data to the remote host. float http_req_waiting Trend Time spent waiting for response from remote host (a.k.a. “time to first byte”, or “TTFB”). float http_req_receiving Trend Time spent receiving response data from the remote host. float http_req_duration Trend Total time for the request. It’s equal to http_req_sending + http_req_waiting + http_req_receiving (i.e. how long did the remote server take to process the request and respond, without the initial DNS lookup/connection times). float http_req_failed Rate The rate of failed requests according to setResponseCallback. Other built-in metrics In addition to the standard built-in metrics and HTTP-specific built-in metrics, K6 built-in metrics also have other built-in metrics:\nBrowser metrics : https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#browser Built-in WebSocket metrics : https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#websockets Built-in gRPC metrics : https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#grpc custom metrics Besides the built-in metrics, you can create custom metrics. For example, you can compute a metric for your business logic, or use the Response.timings object to create a metric for a specific set of endpoints.\nEach metric type has a constructor to create a custom metric. The constructor creates a metric object of the declared type. Each type has an add method to take metric measurements.\nNote: Custom metrics must be created in the init context. This limits memory and ensures that K6 can verify that all thresholds evaluate the defined metrics.\ncustom metrics demo The following example demonstrates how to create a custom trend metrics for wait time:\nThe demo_custom_metrics.js file in the project file already contains this demo example, which can be run directly to view the results.\n1.Import the Trend constructor from the k6/metrics module import { Trend } from 'k6/metrics'; The waiting time trend metrics is a Trends metrics, so the Trend constructor needs to be introduced from the k6/metrics module.\n2.Constructs a new custom metric Trend object in the init context const myTrend = new Trend('waiting_time'); Construct a new custom metric Trend object in the init context, the object in the script is myTrend, and its metric is displayed as waiting_time in the resulting output.\n3.Use the add method in a script to record metric measurements export default function() { const res = http.get('https://test.k6.io'); myTrend.add(res.timings.waiting); } Use the add method in the script to record the metric measurement values. Here, res.timings.waiting is used, which is the waiting time.\n4.demo_custom_metrics.js Complete code of custom metric import http from 'k6/http'; import { Trend } from 'k6/metrics'; const myTrend = new Trend('waiting_time'); export default function () { const res = http.get('https://httpbin.test.k6.io'); myTrend.add(res.timings.waiting); console.log(myTrend.name); // waiting_time } 5.Run demo_custom_metrics.js and view automated trending metrics k6 run demo_custom_metrics.js The running results are as follows:\nAs you can see, the custom metric waiting_time has been displayed in the result output.\nFor more information about custom metrics, please refer to the official documentation: https://k6.io/docs/using-k6/metrics/#custom-metrics\nChecks This can also be understood as assertions, which verify the test results.\nChecks are used to verify whether specific test conditions in different tests are correctly responded to, similar to how we conventionally verify test results in other types of tests to ensure that the system responds as expected.\nFor example, a check can ensure that the response status of a POST request is 201, or that the size of the response body matches expectations.\nChecks are similar to the concept of assertions in many testing frameworks, but K6 does not abort the test or end it in a failed state when verifications fail. Instead, k6 tracks the failure rate of failed verifications as the test continues to run.\nEach check creates a rate metric. To make a check abort or cause the test to fail, it can be combined with thresholds.\nBelow, we will introduce how to use different types of checks and how to view check results in test results.\n1. Check HTTP Response Status K6 checks are particularly useful for response assertions related to HTTP requests.\nFor example, the following code snippet checks that the HTTP response code is 200:\nimport { check } from 'k6'; import http from 'k6/http'; export default function () { const res = http.get('https://httpbin.test.k6.io'); check(res, { 'HTTP response code is status 200': (r) =\u003e r.status === 200, }); } Running this script, you can see the following results:\nWhen a script contains checks, the summary report shows how many test checks have passed.\nIn this example, note that the check “HTTP response code is status 200” is 100% successful when called.\n2. Check HTTP Response Body In addition to checking the HTTP response status, you can also check the HTTP response body.\nFor example, the following code snippet checks that the HTTP response body size is 9591 bytes:\nimport { check } from 'k6'; import http from 'k6/http'; export default function () { const res = http.get('https://httpbin.test.k6.io'); check(res, { 'HTTP response body size is 9591 bytes': (r) =\u003e r.body.length == 9591, }); } Running this script, you can see the following results:\nWhen a script contains checks, the summary report shows how many test checks have passed.\nIn this example, note that the check “HTTP response body size is 9591 bytes” is 100% successful when called.\n3. Adding Multiple Checks Sometimes, multiple checks need to be added in a single test script. You can directly add multiple checks in a single check() statement, as shown in the script below:\nimport { check } from 'k6'; import http from 'k6/http'; export default function () { const res = http.get('https://httpbin.test.k6.io'); check(res, { 'HTTP response code is status 200': (r) =\u003e r.status === 200, 'HTTP response body size is 9591 bytes': (r) =\u003e r.body.length == 9591, }); } Running this script, you can see the following results:\nIn this example, both checks pass successfully (the call is 100% successful).\nNote: When a check fails, the script will continue to execute successfully and will not return a “failed” exit status. If you need to fail the entire test based on check results, you must combine checks with thresholds. This is particularly useful in specific environments, such as integrating k6 into a CI pipeline or receiving alerts when scheduling performance tests.\nReferences Official K6 documentation: https://k6.io/docs/ Official website: https://k6.io/ K6 Performance Test quick starter: https://github.com/Automation-Test-Starter/K6-Performance-Test-starter/ ","wordCount":"1855","inLanguage":"en","datePublished":"2024-01-11T17:10:00+08:00","dateModified":"2024-01-11T17:10:00+08:00","author":{"@type":"Person","name":"nao.deng"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://naodeng.com.cn/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/"},"publisher":{"@type":"Organization","name":"Nao's Blog","logo":{"@type":"ImageObject","url":"https://naodeng.com.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://naodeng.com.cn/ accesskey=h title="Nao's Blog (Alt + H)">Nao's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://naodeng.com.cn/zh/ title=🇨🇳中文 aria-label=🇨🇳中文>🇨🇳中文</a></li></ul></div></div><ul id=menu><li><a href=https://naodeng.com.cn/archives title=Archive><span>Archive</span></a></li><li><a href=https://naodeng.com.cn/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://naodeng.com.cn/series/ title=Series><span>Series</span></a></li><li><a href=https://naodeng.com.cn/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://naodeng.com.cn/>Home</a>&nbsp;»&nbsp;<a href=https://naodeng.com.cn/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks</h1><div class=post-meta><span title='2024-01-11 17:10:00 +0800 +0800'>January 11, 2024</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1855 words&nbsp;·&nbsp;nao.deng&nbsp;|&nbsp;Translations:<ul class=i18n_list><li><a href=https://naodeng.com.cn/zh/posts/performance-testing/k6-tutorial-common-functions-1-http-request-metrics-and-checks/>🇨🇳中文</a></li></ul>&nbsp;|&nbsp;<a href=https://github.com/naodeng/naodeng.com.cn/tree/main/content/posts/Performance-Testing/K6-tutorial-common-functions-1-http-request-metrics-and-checks.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#k6-common-function aria-label="K6 common function">K6 common function</a><ul><li><a href=#http-requests aria-label="HTTP Requests">HTTP Requests</a><ul><li><a href=#get-request-example aria-label="GET Request Example">GET Request Example</a></li><li><a href=#post-request-example aria-label="POST Request Example">POST Request Example</a></li><li><a href=#supported-http-methods aria-label="Supported HTTP Methods">Supported HTTP Methods</a></li><li><a href=#http-request-tags aria-label="HTTP Request Tags">HTTP Request Tags</a></li></ul></li><li><a href=#metrics aria-label=Metrics>Metrics</a><ul><li><a href=#k6-built-in-metrics aria-label="K6 Built-in Metrics">K6 Built-in Metrics</a><ul><li><a href=#standard-built-in-metrics aria-label="Standard Built-in Metrics">Standard Built-in Metrics</a></li><li><a href=#http-specific-built-in-metrics aria-label="HTTP-specific built-in metrics">HTTP-specific built-in metrics</a></li><li><a href=#other-built-in-metrics aria-label="Other built-in metrics">Other built-in metrics</a></li></ul></li><li><a href=#custom-metrics aria-label="custom metrics">custom metrics</a><ul><li><a href=#custom-metrics-demo aria-label="custom metrics demo">custom metrics demo</a><ul><li><a href=#1import-the-trend-constructor-from-the-k6metrics-module aria-label="1.Import the Trend constructor from the k6/metrics module">1.Import the Trend constructor from the k6/metrics module</a></li><li><a href=#2constructs-a-new-custom-metric-trend-object-in-the-init-context aria-label="2.Constructs a new custom metric Trend object in the init context">2.Constructs a new custom metric Trend object in the init context</a></li><li><a href=#3use-the-add-method-in-a-script-to-record-metric-measurements aria-label="3.Use the add method in a script to record metric measurements">3.Use the add method in a script to record metric measurements</a></li><li><a href=#4demo_custom_metricsjs-complete-code-of-custom-metric aria-label="4.demo_custom_metrics.js Complete code of custom metric">4.demo_custom_metrics.js Complete code of custom metric</a></li><li><a href=#5run-demo_custom_metricsjs-and-view-automated-trending-metrics aria-label="5.Run demo_custom_metrics.js and view automated trending metrics">5.Run demo_custom_metrics.js and view automated trending metrics</a></li></ul></li></ul></li></ul></li><li><a href=#checks aria-label=Checks>Checks</a><ul><li><a href=#1-check-http-response-status aria-label="1. Check HTTP Response Status">1. Check HTTP Response Status</a></li><li><a href=#2-check-http-response-body aria-label="2. Check HTTP Response Body">2. Check HTTP Response Body</a></li><li><a href=#3-adding-multiple-checks aria-label="3. Adding Multiple Checks">3. Adding Multiple Checks</a></li></ul></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><h2 id=k6-common-function>K6 common function<a hidden class=anchor aria-hidden=true href=#k6-common-function>#</a></h2><h3 id=http-requests>HTTP Requests<a hidden class=anchor aria-hidden=true href=#http-requests>#</a></h3><p>The first step in performance testing with K6 is to define the HTTP requests to be tested.</p><h4 id=get-request-example>GET Request Example<a hidden class=anchor aria-hidden=true href=#get-request-example>#</a></h4><p>A simple HTTP request for the GET method is already included in the demo test script created with the <code>k6 new</code> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>sleep</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=post-request-example>POST Request Example<a hidden class=anchor aria-hidden=true href=#post-request-example>#</a></h4><p>This POST request example shows the application of some complex scenarios (POST request with email/password authentication load)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>url</span> <span class=o>=</span> <span class=s1>&#39;http://test.k6.io/login&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>payload</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>email</span><span class=o>:</span> <span class=s1>&#39;aaa&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>password</span><span class=o>:</span> <span class=s1>&#39;bbb&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>params</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>http</span><span class=p>.</span><span class=nx>post</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=nx>payload</span><span class=p>,</span> <span class=nx>params</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>The above is taken from <a href=https://k6.io/docs/using-k6/http-requests>K6 Official Documentation</a></p></blockquote><h4 id=supported-http-methods>Supported HTTP Methods<a hidden class=anchor aria-hidden=true href=#supported-http-methods>#</a></h4><p>The HTTP module provided by K6 can handle various HTTP requests and methods. The following is a list of supported HTTP methods:</p><table><thead><tr><th>NAME</th><th>VALUE</th></tr></thead><tbody><tr><td>batch()</td><td>makes multiple HTTP requests in parallel (like e.g. browsers tend to do).</td></tr><tr><td>del()</td><td>makes an HTTP DELETE request.</td></tr><tr><td>get()</td><td>makes an HTTP GET request.</td></tr><tr><td>head()</td><td>makes an HTTP HEAD request.</td></tr><tr><td>options()</td><td>makes an HTTP OPTIONS request.</td></tr><tr><td>patch()</td><td>makes an HTTP PATCH request.</td></tr><tr><td>post()</td><td>makes an HTTP POST request.</td></tr><tr><td>put()</td><td>makes an HTTP PUT request.</td></tr><tr><td>request()</td><td>makes any type of HTTP request.</td></tr></tbody></table><h4 id=http-request-tags>HTTP Request Tags<a hidden class=anchor aria-hidden=true href=#http-request-tags>#</a></h4><p>K6 allows you to add tags to each HTTP request. Combining tags and grouping makes it easy to better organize in test results, group requests and filter results to organize analysis.</p><p>The following is a list of supported tags:</p><table><thead><tr><th>NAME</th><th>DESCRIPTION</th></tr></thead><tbody><tr><td>expected_response</td><td>By default, response statuses between 200 and 399 are true. Change the default behavior with <code>setResponseCallback</code>.</td></tr><tr><td>group</td><td>When the request runs inside a <code>group</code>, the tag value is the group name. Default is empty.</td></tr><tr><td>name</td><td>Defaults to URL requested</td></tr><tr><td>method</td><td>Request method (GET, POST, PUT etc.)</td></tr><tr><td>scenario</td><td>When the request runs inside a <code>scenario</code>, the tag value is the scenario name. Default is <code>default</code>.</td></tr><tr><td>status</td><td>response status</td></tr><tr><td>url</td><td>defaults to URL requested</td></tr></tbody></table><p>Examples of HTTP requests using tag and group tags will be shown in subsequent demos.</p><p>You can also refer to the official examples:<a href=https://grafana.com/docs/k6/latest/using-k6/http-requests/>https://grafana.com/docs/k6/latest/using-k6/http-requests/</a></p><h3 id=metrics>Metrics<a hidden class=anchor aria-hidden=true href=#metrics>#</a></h3><p>The metrics are used to measure the performance of the system under test conditions. By default, k6 automatically collects built-in metrics. In addition to the built-in metrics, you can create custom metrics.</p><p>Metrics generally fall into four categories:</p><ol><li>Counters: Summing values.</li><li>Gauges: Tracking the smallest, largest, and most recent values.</li><li>Rates: Tracking how often non-zero values occur.</li><li>Trends: Calculating statistical information (such as mean, mode, or percentile) for multiple values.</li></ol><p>To ensure that test assertions meet the criteria, thresholds can be written based on the conditions of the metrics required by the performance test (the specifics of the expression depend on the type of metric).</p><p>For subsequent filtering of metrics, labels and groupings can be used, allowing for better organization of test results.</p><blockquote><p>The test results output file can export metrics in a variety of summary and fine-grained formats. For more information, refer to the results output documentation. (This section will be covered in more detail in the later part of the test results output documentation.)</p></blockquote><h4 id=k6-built-in-metrics>K6 Built-in Metrics<a hidden class=anchor aria-hidden=true href=#k6-built-in-metrics>#</a></h4><p>Every k6 test execution emits both built-in and custom metrics. Each supported protocol also has its specific metrics.</p><h5 id=standard-built-in-metrics>Standard Built-in Metrics<a hidden class=anchor aria-hidden=true href=#standard-built-in-metrics>#</a></h5><p>Regardless of the protocol used in the test, k6 always collects the following metrics:</p><table><thead><tr><th>Metric Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>vus</td><td>Gauge</td><td>Current number of active virtual users</td></tr><tr><td>vus_max</td><td>Gauge</td><td>Max possible number of virtual users (VU resources are pre-allocated, to avoid affecting performance when scaling up load )</td></tr><tr><td>iterations</td><td>Counter</td><td>The aggregate number of times the VUs execute the JS script (the default function).</td></tr><tr><td>iteration_duration</td><td>Trend</td><td>The time to complete one full iteration, including time spent in setup and teardown. To calculate the duration of the iteration’s function for the specific scenario, try this workaround</td></tr><tr><td>dropped_iterations</td><td>Counter</td><td>The number of iterations that weren’t started due to lack of VUs (for the arrival-rate executors) or lack of time (expired maxDuration in the iteration-based executors). About dropped iterations</td></tr><tr><td>data_received</td><td>Counter</td><td>The amount of received data. This example covers how to track data for an individual URL.</td></tr><tr><td>data_sent</td><td>Counter</td><td>The amount of data sent. Track data for an individual URL to track data for an individual URL.</td></tr><tr><td>checks</td><td>Rate</td><td>The rate of successful checks.</td></tr></tbody></table><h5 id=http-specific-built-in-metrics>HTTP-specific built-in metrics<a hidden class=anchor aria-hidden=true href=#http-specific-built-in-metrics>#</a></h5><p>HTTP-specific built-in metrics are generated only when the test makes HTTP requests.Other types of requests, such as WebSocket, do not generate these metrics.</p><blockquote><p>Note: For all http_req_* metrics, the timestamp is emitted at the end of the request. In other words, the timestamp occurs when k6 receives the end of the response body or when the request times out.</p></blockquote><p>The following table lists HTTP-specific built-in metrics:</p><table><thead><tr><th>Metric Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>http_reqs</td><td>Counter</td><td>How many total HTTP requests k6 generated.</td></tr><tr><td>http_req_blocked</td><td>Trend</td><td>Time spent blocked (waiting for a free TCP connection slot) before initiating the request. float</td></tr><tr><td>http_req_connecting</td><td>Trend</td><td>Time spent establishing TCP connection to the remote host. float</td></tr><tr><td>http_req_tls_handshaking</td><td>Trend</td><td>Time spent handshaking TLS session with remote host</td></tr><tr><td>http_req_sending</td><td>Trend</td><td>Time spent sending data to the remote host. float</td></tr><tr><td>http_req_waiting</td><td>Trend</td><td>Time spent waiting for response from remote host (a.k.a. “time to first byte”, or “TTFB”). float</td></tr><tr><td>http_req_receiving</td><td>Trend</td><td>Time spent receiving response data from the remote host. float</td></tr><tr><td>http_req_duration</td><td>Trend</td><td>Total time for the request. It’s equal to http_req_sending + http_req_waiting + http_req_receiving (i.e. how long did the remote server take to process the request and respond, without the initial DNS lookup/connection times). float</td></tr><tr><td>http_req_failed</td><td>Rate</td><td>The rate of failed requests according to setResponseCallback.</td></tr></tbody></table><h5 id=other-built-in-metrics>Other built-in metrics<a hidden class=anchor aria-hidden=true href=#other-built-in-metrics>#</a></h5><p>In addition to the standard built-in metrics and HTTP-specific built-in metrics, K6 built-in metrics also have other built-in metrics:</p><ul><li>Browser metrics : <a href=https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#browser>https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#browser</a></li><li>Built-in WebSocket metrics : <a href=https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#websockets>https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#websockets</a></li><li>Built-in gRPC metrics : <a href=https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#grpc>https://grafana.com/docs/k6/latest/using-k6/metrics/reference/#grpc</a></li></ul><h4 id=custom-metrics>custom metrics<a hidden class=anchor aria-hidden=true href=#custom-metrics>#</a></h4><p>Besides the built-in metrics, you can create custom metrics. For example, you can compute a metric for your business logic, or use the Response.timings object to create a metric for a specific set of endpoints.</p><p>Each metric type has a constructor to create a custom metric. The constructor creates a metric object of the declared type. Each type has an add method to take metric measurements.</p><blockquote><p>Note: Custom metrics must be created in the init context. This limits memory and ensures that K6 can verify that all thresholds evaluate the defined metrics.</p></blockquote><h5 id=custom-metrics-demo>custom metrics demo<a hidden class=anchor aria-hidden=true href=#custom-metrics-demo>#</a></h5><p>The following example demonstrates how to create a custom trend metrics for wait time:</p><blockquote><p>The demo_custom_metrics.js file in the project file already contains this demo example, which can be run directly to view the results.</p></blockquote><h6 id=1import-the-trend-constructor-from-the-k6metrics-module>1.Import the Trend constructor from the k6/metrics module<a hidden class=anchor aria-hidden=true href=#1import-the-trend-constructor-from-the-k6metrics-module>#</a></h6><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Trend</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6/metrics&#39;</span><span class=p>;</span>
</span></span></code></pre></div><blockquote><blockquote><p>The waiting time trend metrics is a Trends metrics, so the Trend constructor needs to be introduced from the k6/metrics module.</p></blockquote></blockquote><h6 id=2constructs-a-new-custom-metric-trend-object-in-the-init-context>2.Constructs a new custom metric Trend object in the init context<a hidden class=anchor aria-hidden=true href=#2constructs-a-new-custom-metric-trend-object-in-the-init-context>#</a></h6><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>myTrend</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Trend</span><span class=p>(</span><span class=s1>&#39;waiting_time&#39;</span><span class=p>);</span>
</span></span></code></pre></div><blockquote><p>Construct a new custom metric Trend object in the init context, the object in the script is myTrend, and its metric is displayed as <code>waiting_time</code> in the resulting output.</p></blockquote><h6 id=3use-the-add-method-in-a-script-to-record-metric-measurements>3.Use the add method in a script to record metric measurements<a hidden class=anchor aria-hidden=true href=#3use-the-add-method-in-a-script-to-record-metric-measurements>#</a></h6><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>myTrend</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>timings</span><span class=p>.</span><span class=nx>waiting</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><blockquote><p>Use the add method in the script to record the metric measurement values. Here, <code>res.timings.waiting</code> is used, which is the waiting time.</p></blockquote><h6 id=4demo_custom_metricsjs-complete-code-of-custom-metric>4.demo_custom_metrics.js Complete code of custom metric<a hidden class=anchor aria-hidden=true href=#4demo_custom_metricsjs-complete-code-of-custom-metric>#</a></h6><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>Trend</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6/metrics&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>myTrend</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Trend</span><span class=p>(</span><span class=s1>&#39;waiting_time&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://httpbin.test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>myTrend</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>res</span><span class=p>.</span><span class=nx>timings</span><span class=p>.</span><span class=nx>waiting</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>myTrend</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span> <span class=c1>// waiting_time
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div><h6 id=5run-demo_custom_metricsjs-and-view-automated-trending-metrics>5.Run demo_custom_metrics.js and view automated trending metrics<a hidden class=anchor aria-hidden=true href=#5run-demo_custom_metricsjs-and-view-automated-trending-metrics>#</a></h6><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>k6 run demo_custom_metrics.js
</span></span></code></pre></div><p>The running results are as follows:</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/4tbqVc.png alt=" "></p><blockquote><p>As you can see, the custom metric <code>waiting_time</code> has been displayed in the result output.</p></blockquote><p>For more information about custom metrics, please refer to the official documentation: <a href=https://k6.io/docs/using-k6/metrics/#custom-metrics>https://k6.io/docs/using-k6/metrics/#custom-metrics</a></p><h3 id=checks>Checks<a hidden class=anchor aria-hidden=true href=#checks>#</a></h3><blockquote><p>This can also be understood as assertions, which verify the test results.</p></blockquote><p>Checks are used to verify whether specific test conditions in different tests are correctly responded to, similar to how we conventionally verify test results in other types of tests to ensure that the system responds as expected.</p><p>For example, a check can ensure that the response status of a POST request is 201, or that the size of the response body matches expectations.</p><p>Checks are similar to the concept of assertions in many testing frameworks, but <strong>K6 does not abort the test or end it in a failed state when verifications fail. Instead, k6 tracks the failure rate of failed verifications as the test continues to run</strong>.</p><blockquote><p>Each check creates a rate metric. To make a check abort or cause the test to fail, it can be combined with thresholds.</p></blockquote><p>Below, we will introduce how to use different types of checks and how to view check results in test results.</p><h4 id=1-check-http-response-status>1. Check HTTP Response Status<a hidden class=anchor aria-hidden=true href=#1-check-http-response-status>#</a></h4><p>K6 checks are particularly useful for response assertions related to HTTP requests.</p><p>For example, the following code snippet checks that the HTTP response code is 200:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>check</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://httpbin.test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>check</span><span class=p>(</span><span class=nx>res</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;HTTP response code is status 200&#39;</span><span class=o>:</span> <span class=p>(</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Running this script, you can see the following results:</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/aTXnpy.png alt=" "></p><blockquote><p>When a script contains checks, the summary report shows how many test checks have passed.</p></blockquote><p>In this example, note that the check &ldquo;HTTP response code is status 200&rdquo; is 100% successful when called.</p><h4 id=2-check-http-response-body>2. Check HTTP Response Body<a hidden class=anchor aria-hidden=true href=#2-check-http-response-body>#</a></h4><p>In addition to checking the HTTP response status, you can also check the HTTP response body.</p><p>For example, the following code snippet checks that the HTTP response body size is 9591 bytes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>check</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://httpbin.test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>check</span><span class=p>(</span><span class=nx>res</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;HTTP response body size is 9591 bytes&#39;</span><span class=o>:</span> <span class=p>(</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>length</span> <span class=o>==</span> <span class=mi>9591</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Running this script, you can see the following results:</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/AmbL0E.png alt=" "></p><blockquote><p>When a script contains checks, the summary report shows how many test checks have passed.</p></blockquote><p>In this example, note that the check &ldquo;HTTP response body size is 9591 bytes&rdquo; is 100% successful when called.</p><h4 id=3-adding-multiple-checks>3. Adding Multiple Checks<a hidden class=anchor aria-hidden=true href=#3-adding-multiple-checks>#</a></h4><p>Sometimes, multiple checks need to be added in a single test script. You can directly add multiple checks in a single check() statement, as shown in the script below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>check</span> <span class=p>}</span> <span class=nx>from</span> <span class=s1>&#39;k6&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=nx>http</span> <span class=nx>from</span> <span class=s1>&#39;k6/http&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>res</span> <span class=o>=</span> <span class=nx>http</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;https://httpbin.test.k6.io&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>check</span><span class=p>(</span><span class=nx>res</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;HTTP response code is status 200&#39;</span><span class=o>:</span> <span class=p>(</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>200</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;HTTP response body size is 9591 bytes&#39;</span><span class=o>:</span> <span class=p>(</span><span class=nx>r</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>r</span><span class=p>.</span><span class=nx>body</span><span class=p>.</span><span class=nx>length</span> <span class=o>==</span> <span class=mi>9591</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Running this script, you can see the following results:</p><p><img loading=lazy src=https://cdn.jsdelivr.net/gh/naodeng/blogimg@master/uPic/5yJyBw.png alt=" "></p><p>In this example, both checks pass successfully (the call is 100% successful).</p><blockquote><p>Note: When a check fails, the script will continue to execute successfully and will not return a &ldquo;failed&rdquo; exit status. If you need to fail the entire test based on check results, you must combine checks with thresholds. This is particularly useful in specific environments, such as integrating k6 into a CI pipeline or receiving alerts when scheduling performance tests.</p></blockquote><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://k6.io/docs/>Official K6 documentation: https://k6.io/docs/</a></li><li><a href=https://k6.io/>Official website: https://k6.io/</a></li><li><a href=https://github.com/Automation-Test-Starter/K6-Performance-Test-starter>K6 Performance Test quick starter: https://github.com/Automation-Test-Starter/K6-Performance-Test-starter/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://naodeng.com.cn/tags/common-functions/>Common Functions</a></li><li><a href=https://naodeng.com.cn/tags/http-request/>HTTP request</a></li><li><a href=https://naodeng.com.cn/tags/metrics/>metrics</a></li><li><a href=https://naodeng.com.cn/tags/checks/>checks</a></li></ul><nav class=paginav><a class=prev href=https://naodeng.com.cn/posts/performance-testing/k6-tutorial-advanced-usage-output-html-report-and-ci-cd-integration.zh./><span class=title>« Prev</span><br><span>K6 性能测试教程 - 进阶用法：输出 html 报告和 CI/CD 集成</span>
</a><a class=next href=https://naodeng.com.cn/posts/performance-testing/k6-tutorial-getting-started-and-your-first-k6-test-script/><span class=title>Next »</span><br><span>K6 Performance Testing Tutorial: Getting Started and Write your first k6 test script</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on x" href="https://x.com/intent/tweet/?text=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks&amp;url=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f&amp;hashtags=CommonFunctions%2cHTTPrequest%2cmetrics%2cchecks"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f&amp;title=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks&amp;summary=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks&amp;source=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f&title=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on whatsapp" href="https://api.whatsapp.com/send?text=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks%20-%20https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on telegram" href="https://telegram.me/share/url?text=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks&amp;url=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share K6 Performance Testing Tutorial: Common Functions (1) - HTTP Request, Metrics and Checks on ycombinator" href="https://news.ycombinator.com/submitlink?t=K6%20Performance%20Testing%20Tutorial%3a%20Common%20Functions%20%281%29%20-%20HTTP%20Request%2c%20Metrics%20and%20Checks&u=https%3a%2f%2fnaodeng.com.cn%2fposts%2fperformance-testing%2fk6-tutorial-common-functions-1-http-request-metrics-and-checks%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=naodeng/naodeng.tech data-repo-id=R_kgDOHntNtg data-category="Show and tell" data-category-id=DIC_kwDOHntNts4Cavst data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=light data-lang=en crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://naodeng.com.cn/>Nao's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>